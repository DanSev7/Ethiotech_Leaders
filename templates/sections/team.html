{% load icon_filters %}
{% load custom_filters %}
{% comment %}/* stylelint-disable */{% endcomment %}

<div class="team-section py-12 md:py-24" style="background-color: #0f172b;">
  <div class="container mx-auto px-4">
    
    {# --- Section Header (Responsive Text) --- #}
    <div class="text-center mb-12 md:mb-16">
      {% if section.name %}
      <h2 class="text-3xl sm:text-4xl md:text-5xl font-extrabold mb-3 text-white">
        {{ section.name }}
      </h2>
      {% endif %}
      
      {% if section.description %}
      <div class="text-base sm:text-xl max-w-3xl mx-auto ck-content text-gray-300">
        {{ section.description|safe }}
      </div>
      {% endif %}
    </div>
    
    {# --- Team Members Carousel --- #}
    <div class="relative">
      <div class="overflow-hidden">
        <div class="flex transition-transform duration-500 ease-in-out" id="teamCarousel">
          {% for card in section.card_block.all %}
          {% if card.is_active %}
          
          {# Card Container #}
          <div class="flex-shrink-0 w-full sm:w-1/2 lg:w-1/3 px-4">
            <div class="group text-center p-6 sm:p-8 rounded-xl sm:rounded-2xl shadow-xl transition-all duration-500 hover:shadow-2xl" 
                 style="background-color: #1d293b;">
              
              {# 1. Team Member Photo (Rounded) #}
              {% if card.image %}
              <div class="mb-6 mx-auto w-32 h-32 relative overflow-hidden rounded-full border-4 border-white shadow-lg">
                <img src="{{ card.image.url }}" 
                     alt="{{ card.image_alt|default:card.title }}" 
                     class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105">
              </div>
              {% endif %}
              
              {# 2. Team Member Name #}
              <h3 class="text-xl sm:text-2xl font-bold mb-2 text-white">
                {{ card.title }}
              </h3>
              
              {# 3. Role/Bio #}
              {% if card.cta_label %}
              <p class="text-sm sm:text-md font-medium mb-4" style="color: #09b6d4;">
                {{ card.cta_label }}
              </p>
              {% endif %}
              
              {# 4. Bio/Description #}
              {% if card.text %}
              <div class="ck-content mb-4 text-xs sm:text-sm text-gray-300">
                {{ card.text|safe }}
              </div>
              {% endif %}
              
              {# 5. Social Media Links #}
              {% if card.cta_url %}
              <div class="flex justify-center space-x-3 pt-2">
                <a href="{{ card.cta_url }}" 
                   target="_blank" 
                   rel="noopener noreferrer"
                   class="flex items-center justify-center w-10 h-10 rounded-full transition-all hover:scale-110" 
                   style="background-color: #09b6d4;">
                  <i data-lucide="link" class="w-4 h-4 text-white"></i>
                </a>
              </div>
              {% endif %}
            </div>
          </div>
          
          {% endif %}
          {% endfor %}
        </div>
      </div>
      
      <!-- Navigation Arrows -->
      <button id="prevTeam" class="absolute left-0 top-1/2 transform -translate-y-1/2 -translate-x-6 bg-cyan-500 rounded-full p-3 shadow-lg hover:bg-cyan-600 transition">
        <i data-lucide="chevron-left" class="w-6 h-6 text-white"></i>
      </button>
      <button id="nextTeam" class="absolute right-0 top-1/2 transform -translate-y-1/2 translate-x-6 bg-cyan-500 rounded-full p-3 shadow-lg hover:bg-cyan-600 transition">
        <i data-lucide="chevron-right" class="w-6 h-6 text-white"></i>
      </button>
      
      <!-- Dots Indicator -->
      <div class="flex justify-center mt-8 space-x-2" id="teamDots">
        <!-- Dots will be generated by JavaScript -->
      </div>
    </div>
    
    {# --- Section CTA Button --- #}
    {% if section.cta_label and section.cta_url %}
    <div class="mt-12 md:mt-16 text-center">
        <a href="{{ section.cta_url }}" 
           target="{{ section.cta_target|default:'_self' }}"
           class="inline-block px-8 py-3 sm:px-10 sm:py-4 rounded-full font-bold text-base sm:text-lg transition-all transform hover:scale-105 shadow-xl"
           style="background-color: #09b6d4; color: white;">
            {{ section.cta_label }}
        </a>
    </div>
    {% endif %}
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const carousel = document.getElementById('teamCarousel');
  const prevBtn = document.getElementById('prevTeam');
  const nextBtn = document.getElementById('nextTeam');
  const dotsContainer = document.getElementById('teamDots');
  
  if (carousel && prevBtn && nextBtn) {
    const cards = carousel.children;
    const cardCount = cards.length;
    let currentIndex = 0;
    
    // Always show one card at a time
    function getVisibleCards() {
      return 1;
    }
    
    let visibleCards = getVisibleCards();
    
    // Create dots
    if (dotsContainer && cardCount > 0) {
      for (let i = 0; i < cardCount; i++) {
        const dot = document.createElement('button');
        dot.className = 'w-3 h-3 rounded-full bg-gray-600 hover:bg-gray-400 transition';
        dot.dataset.index = i;
        if (i === 0) dot.classList.add('bg-cyan-500');
        dot.addEventListener('click', () => goToSlide(i));
        dotsContainer.appendChild(dot);
      }
    }
    
    function updateCarousel() {
      const cardWidth = cards[0].offsetWidth;
      carousel.style.transform = `translateX(-${currentIndex * cardWidth}px)`;
      
      // Update dots
      if (dotsContainer) {
        const dots = dotsContainer.children;
        for (let i = 0; i < dots.length; i++) {
          dots[i].classList.toggle('bg-cyan-500', i === currentIndex);
          dots[i].classList.toggle('bg-gray-600', i !== currentIndex);
        }
      }
    }
    
    function goToSlide(index) {
      currentIndex = index;
      updateCarousel();
    }
    
    function nextSlide() {
      currentIndex = (currentIndex + 1) % cardCount;
      updateCarousel();
    }
    
    function prevSlide() {
      currentIndex = (currentIndex - 1 + cardCount) % cardCount;
      updateCarousel();
    }
    
    prevBtn.addEventListener('click', prevSlide);
    nextBtn.addEventListener('click', nextSlide);
    
    // Auto slide every 5 seconds
    setInterval(nextSlide, 5000);
    
    // Handle window resize
    window.addEventListener('resize', function() {
      visibleCards = getVisibleCards();
      updateCarousel();
    });
  }
});
</script>